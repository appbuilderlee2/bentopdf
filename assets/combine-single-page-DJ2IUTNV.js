import{c as X,i as Y}from"./style-BMqLG_Qf.js";import"./lucide-init-Css57rKe.js";import"./simple-mode-footer-WbVs9YeG.js";import"./version-Cc_uNslJ.js";import{G as J,a as b,f as O,b as C,h as F,n as $,c as V,d as Z}from"./main-DSprMeGA.js";import{P as M,r as k}from"./PDFButton-BowUC9ah.js";import"./mobileMenu-BoMunYmR.js";import"./index-YkV0U4e7.js";J.workerSrc=new URL("/assets/pdf.worker.min-LyOxJPrg.mjs",import.meta.url).toString();const a={file:null,pdfDoc:null};function S(){a.file=null,a.pdfDoc=null;const t=document.getElementById("file-display-area");t&&(t.innerHTML="");const e=document.getElementById("tool-options");e&&e.classList.add("hidden");const i=document.getElementById("file-input");i&&(i.value="")}async function _(){const t=document.getElementById("file-display-area"),e=document.getElementById("tool-options");if(t)if(t.innerHTML="",a.file){const i=document.createElement("div");i.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const g=document.createElement("div");g.className="flex flex-col overflow-hidden";const r=document.createElement("div");r.className="truncate font-medium text-gray-200 text-sm mb-1",r.textContent=a.file.name;const s=document.createElement("div");s.className="text-xs text-gray-400",s.textContent=`${O(a.file.size)} • Loading...`,g.append(r,s);const n=document.createElement("button");n.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",n.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',n.onclick=function(){S()},i.append(g,n),t.appendChild(i),X({icons:Y});try{C("Loading PDF...");const o=await a.file.arrayBuffer();a.pdfDoc=await M.load(o,{ignoreEncryption:!0,throwOnInvalidObject:!1}),F();const d=a.pdfDoc.getPageCount();s.textContent=`${O(a.file.size)} • ${d} pages`,e&&e.classList.remove("hidden")}catch(o){console.error("Error loading PDF:",o),F(),b("Error","Failed to load PDF file."),S()}}else e&&e.classList.add("hidden")}async function q(){if(!a.pdfDoc||!a.file){b("Error","Please upload a PDF first.");return}const t=document.getElementById("combine-orientation").value,e=parseInt(document.getElementById("page-spacing").value)||0,i=document.getElementById("background-color").value,g=document.getElementById("add-separator").checked,r=parseFloat(document.getElementById("separator-thickness").value)||.5,s=document.getElementById("separator-color").value,n=$(i),o=$(s);C("Combining pages...");try{const d=a.pdfDoc,f=await M.create(),N=await d.save(),U=await V({data:N}).promise,p=d.getPages();let D=0,B=0,z=0,T=0;p.forEach(function(m){const{width:v,height:c}=m.getSize();v>D&&(D=v),c>B&&(B=c),z+=v,T+=c});let h,u;t==="horizontal"?(h=z+Math.max(0,p.length-1)*e,u=B):(h=D,u=T+Math.max(0,p.length-1)*e);const y=f.addPage([h,u]);i.toUpperCase()!=="#FFFFFF"&&y.drawRectangle({x:0,y:0,width:h,height:u,color:k(n.r,n.g,n.b)});let x=0,w=u;for(let m=0;m<p.length;m++){C(`Processing page ${m+1} of ${p.length}...`);const v=p[m],{width:c,height:L}=v.getSize();try{const l=await U.getPage(m+1),I=l.getViewport({scale:2}),E=document.createElement("canvas");E.width=I.width,E.height=I.height;const R=E.getContext("2d");await l.render({canvasContext:R,viewport:I,canvas:E}).promise;const G=E.toDataURL("image/png"),H=await f.embedPng(G);if(t==="horizontal"){const P=(u-L)/2;y.drawImage(H,{x,y:P,width:c,height:L})}else{w-=L;const P=(h-c)/2;y.drawImage(H,{x:P,y:w,width:c,height:L})}}catch(l){console.warn(`Failed to render page ${m+1}:`,l)}if(g&&m<p.length-1)if(t==="horizontal"){const l=x+c+e/2;y.drawLine({start:{x:l,y:0},end:{x:l,y:u},thickness:r,color:k(o.r,o.g,o.b)}),x+=c+e}else{const l=w-e/2;y.drawLine({start:{x:0,y:l},end:{x:h,y:l},thickness:r,color:k(o.r,o.g,o.b)}),w-=e}else t==="horizontal"?x+=c+e:w-=e}const W=await f.save(),j=a.file.name.replace(/\.pdf$/i,"");Z(new Blob([new Uint8Array(W)],{type:"application/pdf"}),`${j}_combined.pdf`),b("Success","Pages combined successfully!","success",function(){S()})}catch(d){console.error(d),b("Error","An error occurred while combining pages.")}finally{F()}}function A(t){if(t&&t.length>0){const e=t[0];(e.type==="application/pdf"||e.name.toLowerCase().endsWith(".pdf"))&&(a.file=e,_())}}document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("file-input"),e=document.getElementById("drop-zone"),i=document.getElementById("process-btn"),g=document.getElementById("back-to-tools"),r=document.getElementById("add-separator"),s=document.getElementById("separator-options");g&&g.addEventListener("click",function(){window.location.href="/"}),r&&s&&r.addEventListener("change",function(){r.checked?s.classList.remove("hidden"):s.classList.add("hidden")}),t&&e&&(t.addEventListener("change",function(n){A(n.target.files)}),e.addEventListener("dragover",function(n){n.preventDefault(),e.classList.add("bg-gray-700")}),e.addEventListener("dragleave",function(n){n.preventDefault(),e.classList.remove("bg-gray-700")}),e.addEventListener("drop",function(n){n.preventDefault(),e.classList.remove("bg-gray-700");const o=n.dataTransfer?.files;if(o&&o.length>0){const d=Array.from(o).filter(function(f){return f.type==="application/pdf"||f.name.toLowerCase().endsWith(".pdf")});if(d.length>0){const f=new DataTransfer;f.items.add(d[0]),A(f.files)}}}),t.addEventListener("click",function(){t.value=""})),i&&i.addEventListener("click",q)});
