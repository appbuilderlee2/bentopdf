import{c as p,i as u}from"./style-BMqLG_Qf.js";import"./lucide-init-Css57rKe.js";import"./simple-mode-footer-WbVs9YeG.js";import"./version-Cc_uNslJ.js";import{a as m,f as v,b as w,r as E,d as L,h as b}from"./main-DSprMeGA.js";import{P as B}from"./PDFButton-BowUC9ah.js";import{g as I,a as x}from"./image-compress-D5rNPUMg.js";import"./mobileMenu-BoMunYmR.js";import"./index-YkV0U4e7.js";let i=[];document.readyState==="loading"?document.addEventListener("DOMContentLoaded",g):g();function g(){p({icons:u});const e=document.getElementById("file-input"),t=document.getElementById("drop-zone"),s=document.getElementById("add-more-btn"),r=document.getElementById("clear-files-btn"),o=document.getElementById("process-btn");e&&e.addEventListener("change",k),t&&(t.addEventListener("dragover",a=>{a.preventDefault(),t.classList.add("bg-gray-700")}),t.addEventListener("dragleave",()=>{t.classList.remove("bg-gray-700")}),t.addEventListener("drop",a=>{a.preventDefault(),t.classList.remove("bg-gray-700");const n=a.dataTransfer?.files;n&&n.length>0&&y(n)}),e?.addEventListener("click",()=>{e&&(e.value="")})),s&&s.addEventListener("click",()=>{e?.click()}),r&&r.addEventListener("click",()=>{i=[],f()}),o&&o.addEventListener("click",C),document.getElementById("back-to-tools")?.addEventListener("click",()=>{window.location.href="/"})}function k(e){const t=e.target;t.files&&t.files.length>0&&y(t.files)}function y(e){const t=Array.from(e).filter(s=>s.type==="image/png"||s.name.toLowerCase().endsWith(".png"));t.length<e.length&&m("Invalid Files","Some files were skipped. Only PNG images are allowed."),t.length>0&&(i=[...i,...t],f())}const P=()=>{i=[],f()};function f(){const e=document.getElementById("file-display-area"),t=document.getElementById("file-controls"),s=document.getElementById("jpg-to-pdf-options");!e||!t||!s||(e.innerHTML="",i.length>0?(t.classList.remove("hidden"),s.classList.remove("hidden"),i.forEach((r,o)=>{const a=document.createElement("div");a.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const n=document.createElement("div");n.className="flex items-center gap-2 overflow-hidden";const l=document.createElement("span");l.className="truncate font-medium text-gray-200",l.textContent=r.name;const d=document.createElement("span");d.className="flex-shrink-0 text-gray-400 text-xs",d.textContent=`(${v(r.size)})`,n.append(l,d);const c=document.createElement("button");c.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",c.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',c.onclick=()=>{i=i.filter((D,h)=>h!==o),f()},a.append(n,c),e.appendChild(a)}),p({icons:u})):(t.classList.add("hidden"),s.classList.add("hidden")))}function U(e){return new Promise((t,s)=>{const r=new Blob([e]),o=URL.createObjectURL(r),a=new Image;a.onload=()=>{const n=document.createElement("canvas");n.width=a.naturalWidth,n.height=a.naturalHeight,n.getContext("2d").drawImage(a,0,0),n.toBlob(async d=>{if(!d)return s(new Error("Canvas toBlob conversion failed."));const c=await d.arrayBuffer();t(new Uint8Array(c))},"image/jpeg",.9),URL.revokeObjectURL(o)},a.onerror=()=>{URL.revokeObjectURL(o),s(new Error("The provided file could not be loaded as an image. It may be corrupted."))},a.src=o})}async function C(){if(i.length===0){m("No Files","Please select at least one JPG file.");return}w("Creating PDF from JPGs...");try{const e=await B.create(),t=I();for(const r of i){const o=await E(r),a=await x(new Uint8Array(o),t);let n;if(a.type==="jpeg")n=await e.embedJpg(a.bytes);else try{n=await e.embedPng(a.bytes)}catch{const d=await U(o);n=await e.embedJpg(d)}e.addPage([n.width,n.height]).drawImage(n,{x:0,y:0,width:n.width,height:n.height})}const s=await e.save();L(new Blob([new Uint8Array(s)],{type:"application/pdf"}),"from_jpgs.pdf"),m("Success","PDF created successfully!","success",()=>{P()})}catch(e){console.error(e),m("Conversion Error",e.message)}finally{b()}}
