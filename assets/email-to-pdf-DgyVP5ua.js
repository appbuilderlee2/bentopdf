const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jszip.min-DhcferR8.js","assets/main-DSprMeGA.js","assets/style-BMqLG_Qf.js","assets/style-CsosqKDh.css","assets/_commonjs-dynamic-modules-TDtrdbi3.js"])))=>i.map(i=>d[i]);
import{c as O,i as H}from"./style-BMqLG_Qf.js";import"./lucide-init-Css57rKe.js";import"./simple-mode-footer-WbVs9YeG.js";import"./version-Cc_uNslJ.js";import{s as t,a as L,b as h,d as P,h as x,_ as R,f as j}from"./main-DSprMeGA.js";import{p as $,r as T}from"./email-to-pdf-AzxOIJvx.js";import{l as Z}from"./pymupdf-loader-BmwcVkri.js";import"./mobileMenu-BoMunYmR.js";import"./index-KBzziK6T.js";import"./wasm-provider-BDZaM2k5.js";const G=[".eml",".msg"],I="Email";document.addEventListener("DOMContentLoaded",()=>{const p=document.getElementById("file-input"),d=document.getElementById("drop-zone"),g=document.getElementById("process-btn"),v=document.getElementById("file-display-area"),b=document.getElementById("file-controls"),D=document.getElementById("add-more-btn"),_=document.getElementById("clear-files-btn"),k=document.getElementById("back-to-tools");k&&k.addEventListener("click",()=>{window.location.href="/"});const E=document.getElementById("convert-options"),B=async()=>{if(!(!v||!g||!b))if(t.files.length>0){v.innerHTML="";for(let e=0;e<t.files.length;e++){const o=t.files[e],i=document.createElement("div");i.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const n=document.createElement("div");n.className="flex flex-col overflow-hidden";const s=document.createElement("div");s.className="truncate font-medium text-gray-200 text-sm mb-1",s.textContent=o.name;const c=document.createElement("div");c.className="text-xs text-gray-400",c.textContent=j(o.size),n.append(s,c);const m=document.createElement("button");m.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",m.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',m.onclick=()=>{t.files=t.files.filter((f,u)=>u!==e),B()},i.append(n,m),v.appendChild(i)}O({icons:H}),b.classList.remove("hidden"),E&&E.classList.remove("hidden"),g.disabled=!1}else v.innerHTML="",b.classList.add("hidden"),E&&E.classList.add("hidden"),g.disabled=!0},w=()=>{t.files=[],t.pdfDoc=null,B()},S=async()=>{try{if(t.files.length===0){L("No Files",`Please select at least one ${I} file (.eml or .msg).`);return}const e=document.getElementById("page-size"),o=document.getElementById("include-cc-bcc"),i=document.getElementById("include-attachments"),n=e?.value||"a4",s=o?.checked??!0,c=i?.checked??!0;h("Loading PDF engine...");const m=await Z();if(t.files.length===1){const f=t.files[0];h(`Parsing ${f.name}...`);const u=await $(f);h("Generating PDF...");const C=T(u,{includeCcBcc:s,includeAttachments:c,pageSize:n}),l=await m.htmlToPdf(C,{pageSize:n,margins:{top:50,right:50,bottom:50,left:50},attachments:u.attachments.filter(a=>a.content).map(a=>({filename:a.filename,content:a.content}))}),r=f.name.replace(/\.[^.]+$/,"")+".pdf";P(l,r),x(),L("Conversion Complete",`Successfully converted ${f.name} to PDF.`,"success",()=>w())}else{h("Converting emails...");const f=(await R(async()=>{const{default:l}=await import("./jszip.min-DhcferR8.js").then(r=>r.j);return{default:l}},__vite__mapDeps([0,1,2,3,4]))).default,u=new f;for(let l=0;l<t.files.length;l++){const r=t.files[l];h(`Converting ${l+1}/${t.files.length}: ${r.name}...`);try{const a=await $(r),N=T(a,{includeCcBcc:s,includeAttachments:c,pageSize:n}),A=await m.htmlToPdf(N,{pageSize:n,margins:{top:50,right:50,bottom:50,left:50},attachments:a.attachments.filter(y=>y.content).map(y=>({filename:y.filename,content:y.content}))}),z=r.name.replace(/\.[^.]+$/,""),M=await A.arrayBuffer();u.file(`${z}.pdf`,M)}catch(a){console.error(`Failed to convert ${r.name}:`,a)}}const C=await u.generateAsync({type:"blob"});P(C,"emails-converted.zip"),x(),L("Conversion Complete",`Successfully converted ${t.files.length} ${I} file(s) to PDF.`,"success",()=>w())}}catch(e){console.error(`[${I}2PDF] ERROR:`,e),x(),L("Error",`An error occurred during conversion. Error: ${e.message}`)}},F=e=>{e&&e.length>0&&(t.files=[...t.files,...Array.from(e)],B())};p&&d&&(p.addEventListener("change",e=>{F(e.target.files)}),d.addEventListener("dragover",e=>{e.preventDefault(),d.classList.add("bg-gray-700")}),d.addEventListener("dragleave",e=>{e.preventDefault(),d.classList.remove("bg-gray-700")}),d.addEventListener("drop",e=>{e.preventDefault(),d.classList.remove("bg-gray-700");const o=e.dataTransfer?.files;if(o&&o.length>0){const i=Array.from(o).filter(n=>{const s=n.name.toLowerCase();return G.some(c=>s.endsWith(c))});if(i.length>0){const n=new DataTransfer;i.forEach(s=>n.items.add(s)),F(n.files)}}}),p.addEventListener("click",()=>{p.value=""})),D&&D.addEventListener("click",()=>{p.click()}),_&&_.addEventListener("click",()=>{w()}),g&&g.addEventListener("click",S)});
