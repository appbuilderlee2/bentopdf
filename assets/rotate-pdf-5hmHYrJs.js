import{c as m,i as u}from"./style-BMqLG_Qf.js";import"./lucide-init-Css57rKe.js";import"./simple-mode-footer-WbVs9YeG.js";import"./version-Cc_uNslJ.js";import{G as x,a as p,f as b,b as v,c as E,h as y,k as D,l as B,d as I}from"./main-DSprMeGA.js";import{P}from"./PDFButton-BowUC9ah.js";import{r as C}from"./pdf-operations-BcGECRsE.js";import"./mobileMenu-BoMunYmR.js";import"./index-YkV0U4e7.js";x.workerSrc=new URL("/assets/pdf.worker.min-LyOxJPrg.mjs",import.meta.url).toString();const e={file:null,pdfDoc:null,pdfJsDoc:null,rotations:[]};function h(){D(),e.file=null,e.pdfDoc=null,e.pdfJsDoc=null,e.rotations=[];const t=document.getElementById("file-display-area");t&&(t.innerHTML="");const n=document.getElementById("tool-options");n&&n.classList.add("hidden");const o=document.getElementById("page-thumbnails");o&&(o.innerHTML="");const r=document.getElementById("file-input");r&&(r.value="")}function w(){for(let t=0;t<e.rotations.length;t++){const n=document.querySelector(`[data-page-index="${t}"]`);if(n){const o=n.querySelector(".thumbnail-wrapper");o&&(o.style.transform=`rotate(${e.rotations[t]}deg)`)}}}function k(t,n){const o=n-1,r=document.createElement("div");r.className="page-thumbnail relative bg-gray-700 rounded-lg overflow-hidden",r.dataset.pageIndex=o.toString(),r.dataset.pageNumber=n.toString();const i=document.createElement("div");i.className="thumbnail-wrapper flex items-center justify-center p-2 h-36",i.style.transition="transform 0.3s ease";const d=e.rotations[o]||0;i.style.transform=`rotate(${d}deg)`,t.className="max-w-full max-h-full object-contain",i.appendChild(t);const a=document.createElement("div");a.className="absolute top-1 left-1 bg-black bg-opacity-60 text-white text-xs px-2 py-1 rounded",a.textContent=`${n}`,r.appendChild(i),r.appendChild(a);const s=document.createElement("div");s.className="flex items-center justify-center gap-2 p-2 bg-gray-800";const l=document.createElement("button");l.className="flex items-center gap-1 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-white rounded border border-gray-600 text-xs",l.innerHTML='<i data-lucide="rotate-ccw" class="w-3 h-3"></i>',l.onclick=function(g){g.stopPropagation(),e.rotations[o]=e.rotations[o]-90;const f=r.querySelector(".thumbnail-wrapper");f&&(f.style.transform=`rotate(${e.rotations[o]}deg)`)};const c=document.createElement("button");return c.className="flex items-center gap-1 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-white rounded border border-gray-600 text-xs",c.innerHTML='<i data-lucide="rotate-cw" class="w-3 h-3"></i>',c.onclick=function(g){g.stopPropagation(),e.rotations[o]=e.rotations[o]+90;const f=r.querySelector(".thumbnail-wrapper");f&&(f.style.transform=`rotate(${e.rotations[o]}deg)`)},s.append(l,c),r.appendChild(s),setTimeout(function(){m({icons:u})},0),r}async function S(){const t=document.getElementById("page-thumbnails");!t||!e.pdfJsDoc||(t.innerHTML="",await B(e.pdfJsDoc,t,k,{batchSize:8,useLazyLoading:!0,lazyLoadMargin:"200px",eagerLoadBatches:2,onBatchComplete:function(){m({icons:u})}}),m({icons:u}))}async function T(){const t=document.getElementById("file-display-area"),n=document.getElementById("tool-options");if(t)if(t.innerHTML="",e.file){const o=document.createElement("div");o.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const r=document.createElement("div");r.className="flex flex-col overflow-hidden";const i=document.createElement("div");i.className="truncate font-medium text-gray-200 text-sm mb-1",i.textContent=e.file.name;const d=document.createElement("div");d.className="text-xs text-gray-400",d.textContent=`${b(e.file.size)} • Loading...`,r.append(i,d);const a=document.createElement("button");a.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",a.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',a.onclick=function(){h()},o.append(r,a),t.appendChild(o),m({icons:u});try{v("Loading PDF...");const s=await e.file.arrayBuffer();e.pdfDoc=await P.load(s.slice(0),{ignoreEncryption:!0,throwOnInvalidObject:!1}),e.pdfJsDoc=await E({data:s.slice(0)}).promise;const l=e.pdfDoc.getPageCount();e.rotations=new Array(l).fill(0),d.textContent=`${b(e.file.size)} • ${l} pages`,await S(),y(),n&&n.classList.remove("hidden")}catch(s){console.error("Error loading PDF:",s),y(),p("Error","Failed to load PDF file."),h()}}else n&&n.classList.add("hidden")}async function N(){if(!e.pdfDoc||!e.file){p("Error","Please upload a PDF first.");return}v("Applying rotations...");try{const t=await e.pdfDoc.save(),n=await C(new Uint8Array(t),e.rotations),o=e.file.name.replace(/\.pdf$/i,"");I(new Blob([n],{type:"application/pdf"}),`${o}_rotated.pdf`),p("Success","Rotations applied successfully!","success",function(){h()})}catch(t){console.error(t),p("Error","Could not apply rotations.")}finally{y()}}function L(t){if(t&&t.length>0){const n=t[0];(n.type==="application/pdf"||n.name.toLowerCase().endsWith(".pdf"))&&(e.file=n,T())}}document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("file-input"),n=document.getElementById("drop-zone"),o=document.getElementById("process-btn"),r=document.getElementById("back-to-tools"),i=document.getElementById("rotate-all-left"),d=document.getElementById("rotate-all-right");r&&r.addEventListener("click",function(){window.location.href="/"}),i&&i.addEventListener("click",function(){for(let a=0;a<e.rotations.length;a++)e.rotations[a]=e.rotations[a]-90;w()}),d&&d.addEventListener("click",function(){for(let a=0;a<e.rotations.length;a++)e.rotations[a]=e.rotations[a]+90;w()}),t&&n&&(t.addEventListener("change",function(a){L(a.target.files)}),n.addEventListener("dragover",function(a){a.preventDefault(),n.classList.add("bg-gray-700")}),n.addEventListener("dragleave",function(a){a.preventDefault(),n.classList.remove("bg-gray-700")}),n.addEventListener("drop",function(a){a.preventDefault(),n.classList.remove("bg-gray-700");const s=a.dataTransfer?.files;if(s&&s.length>0){const l=Array.from(s).filter(function(c){return c.type==="application/pdf"||c.name.toLowerCase().endsWith(".pdf")});if(l.length>0){const c=new DataTransfer;c.items.add(l[0]),L(c.files)}}}),t.addEventListener("click",function(){t.value=""})),o&&o.addEventListener("click",N)});
