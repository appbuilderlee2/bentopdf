import{c as P,i as x}from"./style-BMqLG_Qf.js";import"./lucide-init-Css57rKe.js";import"./simple-mode-footer-WbVs9YeG.js";import"./version-Cc_uNslJ.js";import{G as L,a as m,b as B,r as w,c as E,d as b,h as I,f}from"./main-DSprMeGA.js";import{P as v}from"./PDFButton-BowUC9ah.js";import{d as F}from"./image-effects-Lmx2y_xU.js";import"./mobileMenu-BoMunYmR.js";import"./index-YkV0U4e7.js";L.workerSrc=new URL("/assets/pdf.worker.min-LyOxJPrg.mjs",import.meta.url).toString();let d=[];const u=()=>{const t=document.getElementById("file-display-area"),n=document.getElementById("options-panel"),l=document.getElementById("drop-zone");!t||!n||!l||(t.innerHTML="",d.length>0?(n.classList.remove("hidden"),d.forEach(s=>{const r=document.createElement("div");r.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const e=document.createElement("div");e.className="flex flex-col overflow-hidden";const i=document.createElement("div");i.className="truncate font-medium text-gray-200 text-sm mb-1",i.textContent=s.name;const c=document.createElement("div");c.className="text-xs text-gray-400",c.textContent=`${f(s.size)} • Loading pages...`,e.append(i,c);const o=document.createElement("button");o.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",o.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',o.onclick=()=>{d=[],u()},r.append(e,o),t.appendChild(r),w(s).then(a=>E(a).promise).then(a=>{c.textContent=`${f(s.size)} • ${a.numPages} page${a.numPages!==1?"s":""}`}).catch(a=>{console.warn("Error loading PDF page count:",a),c.textContent=f(s.size)})}),P({icons:x})):n.classList.add("hidden"))},k=()=>{d=[];const t=document.getElementById("file-input");t&&(t.value=""),u()};async function C(){if(d.length===0){m("No File","Please upload a PDF file first.");return}B("Converting to greyscale...");try{const t=await w(d[0]),l=(await v.load(t)).getPages(),s=await E({data:t}).promise,r=await v.create();for(let i=1;i<=s.numPages;i++){const c=await s.getPage(i),o=c.getViewport({scale:2}),a=document.createElement("canvas"),p=a.getContext("2d");a.height=o.height,a.width=o.width,await c.render({canvasContext:p,viewport:o,canvas:a}).promise;const h=p.getImageData(0,0,a.width,a.height);F(h),p.putImageData(h,0,0);const y=await new Promise(g=>a.toBlob(g,"image/jpeg",.9));if(y){const g=await y.arrayBuffer(),D=await r.embedJpg(g);r.addPage([o.width,o.height]).drawImage(D,{x:0,y:0,width:o.width,height:o.height})}}const e=await r.save();b(new Blob([new Uint8Array(e)],{type:"application/pdf"}),"greyscale.pdf"),m("Success","PDF converted to greyscale successfully!","success",()=>{k()})}catch(t){console.error(t),m("Error","Failed to convert PDF to greyscale. The file might be corrupted.")}finally{I()}}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("file-input"),n=document.getElementById("drop-zone"),l=document.getElementById("process-btn"),s=document.getElementById("back-to-tools");s&&s.addEventListener("click",()=>{window.location.href="/"});const r=e=>{if(!e||e.length===0)return;const i=Array.from(e).filter(c=>c.type==="application/pdf");if(i.length===0){m("Invalid File","Please upload a PDF file.");return}d=[i[0]],u()};t&&n&&(t.addEventListener("change",e=>{r(e.target.files)}),n.addEventListener("dragover",e=>{e.preventDefault(),n.classList.add("bg-gray-700")}),n.addEventListener("dragleave",e=>{e.preventDefault(),n.classList.remove("bg-gray-700")}),n.addEventListener("drop",e=>{e.preventDefault(),n.classList.remove("bg-gray-700"),r(e.dataTransfer?.files??null)}),t.addEventListener("click",()=>{t.value=""})),l&&l.addEventListener("click",C)});
