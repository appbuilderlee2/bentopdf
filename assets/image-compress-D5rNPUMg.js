const h={high:{jpegQuality:.92,maxDimension:0},medium:{jpegQuality:.75,maxDimension:2500},low:{jpegQuality:.5,maxDimension:1500}};function w(){const r=document.getElementById("jpg-pdf-quality")?.value;return r==="high"||r==="medium"||r==="low"?r:"medium"}async function U(e,r){if(r==="high")return e;const n=h[r];return new Promise((u,l)=>{const c=new Image,o=URL.createObjectURL(e);c.onload=()=>{let t=c.naturalWidth,a=c.naturalHeight;if(n.maxDimension>0&&(t>n.maxDimension||a>n.maxDimension)){const m=Math.min(n.maxDimension/t,n.maxDimension/a);t=Math.round(t*m),a=Math.round(a*m)}const i=document.createElement("canvas");i.width=t,i.height=a;const s=i.getContext("2d");if(!s){URL.revokeObjectURL(o),l(new Error("Canvas context failed"));return}s.drawImage(c,0,0,t,a),URL.revokeObjectURL(o),i.toBlob(m=>{if(!m){l(new Error("Canvas toBlob failed"));return}const g=e.name.replace(/\.[^.]+$/,".jpg");u(new File([m],g,{type:"image/jpeg"}))},"image/jpeg",n.jpegQuality)},c.onerror=()=>{URL.revokeObjectURL(o),u(e)},c.src=o})}async function f(e,r){if(r==="high")return{bytes:e instanceof Uint8Array?e:new Uint8Array(e),type:"png"};const n=h[r];return new Promise((u,l)=>{const c=new Blob([new Uint8Array(e)]),o=URL.createObjectURL(c),t=new Image;t.onload=()=>{let a=t.naturalWidth,i=t.naturalHeight;if(n.maxDimension>0&&(a>n.maxDimension||i>n.maxDimension)){const g=Math.min(n.maxDimension/a,n.maxDimension/i);a=Math.round(a*g),i=Math.round(i*g)}const s=document.createElement("canvas");s.width=a,s.height=i;const m=s.getContext("2d");if(!m){URL.revokeObjectURL(o),l(new Error("Canvas context failed"));return}m.drawImage(t,0,0,a,i),URL.revokeObjectURL(o),s.toBlob(async g=>{if(!g){l(new Error("Canvas toBlob failed"));return}const d=await g.arrayBuffer();u({bytes:new Uint8Array(d),type:"jpeg"})},"image/jpeg",n.jpegQuality)},t.onerror=()=>{URL.revokeObjectURL(o),u({bytes:e instanceof Uint8Array?e:new Uint8Array(e),type:"png"})},t.src=o})}export{f as a,U as c,w as g};
