import"./style-DHqpffR4.js";import{J as E}from"./jszip.min-CX_3d3rd.js";import{d as w,f as y,r as v}from"./main-X9THBjap.js";import{i as k}from"./shortcuts-init-BgrycUj-.js";import{isCpdfAvailable as L}from"./cpdf-helper-DR2eaTKq.js";import{s as S,W as x}from"./wasm-provider-C9fvsoLq.js";import"./lucide-init-b51_Izr7.js";import"./simple-mode-footer-CTXl6sKe.js";import"./version-Cc_uNslJ.js";import"./mobileMenu-BoMunYmR.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";const f=new Worker("/bentopdf/workers/json-to-pdf.worker.js");let n=[];const m=document.getElementById("jsonFiles"),i=document.getElementById("convertBtn"),l=document.getElementById("status-message"),a=document.getElementById("fileList"),d=document.getElementById("back-to-tools");function r(t,e="info"){l.textContent=t,l.className=`mt-4 p-3 rounded-lg text-sm ${e==="success"?"bg-green-900 text-green-200":e==="error"?"bg-red-900 text-red-200":"bg-blue-900 text-blue-200"}`,l.classList.remove("hidden")}function B(){l.classList.add("hidden")}function N(){if(a.innerHTML="",n.length===0){a.classList.add("hidden");return}a.classList.remove("hidden"),n.forEach(t=>{const e=document.createElement("div");e.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm mb-2";const s=document.createElement("span");s.className="truncate font-medium text-gray-200",s.textContent=t.name;const o=document.createElement("span");o.className="flex-shrink-0 ml-4 text-gray-400",o.textContent=y(t.size),e.append(s,o),a.appendChild(e)})}m.addEventListener("change",t=>{const e=t.target;e.files&&e.files.length>0&&(n=Array.from(e.files),i.disabled=n.length===0,N(),n.length===0?r("Please select at least 1 JSON file","info"):r(`${n.length} file(s) selected. Ready to convert!`,"info"))});async function F(){if(n.length===0){r("Please select at least 1 JSON file","error");return}if(!L()){S("cpdf");return}try{i.disabled=!0,r("Reading files (Main Thread)...","info");const t=await Promise.all(n.map(e=>v(e)));r("Converting JSONs to PDFs...","info"),f.postMessage({command:"convert",fileBuffers:t,fileNames:n.map(e=>e.name),cpdfUrl:x.getUrl("cpdf")+"coherentpdf.browser.min.js"},t)}catch(t){console.error("Error reading files:",t),r(`❌ Error reading files: ${t instanceof Error?t.message:"Unknown error"}`,"error"),i.disabled=!1}}f.onmessage=async t=>{if(i.disabled=!1,t.data.status==="success"){const e=t.data.pdfFiles;try{r("Creating ZIP file...","info");const s=new E;e.forEach(({name:p,data:g})=>{const h=p.replace(/\.json$/i,".pdf"),b=new Uint8Array(g);s.file(h,b)});const o=await s.generateAsync({type:"blob"}),u=URL.createObjectURL(o),c=document.createElement("a");c.href=u,c.download="jsons-to-pdf.zip",w(o,"jsons-to-pdf.zip"),r("✅ JSONs converted to PDF successfully! ZIP download started.","success"),n=[],m.value="",a.innerHTML="",a.classList.add("hidden"),i.disabled=!0,setTimeout(()=>{B()},3e3)}catch(s){console.error("Error creating ZIP:",s),r(`❌ Error creating ZIP: ${s instanceof Error?s.message:"Unknown error"}`,"error")}}else if(t.data.status==="error"){const e=t.data.message||"Unknown error occurred in worker.";console.error("Worker Error:",e),r(`❌ Worker Error: ${e}`,"error")}};d&&d.addEventListener("click",()=>{window.location.href="/bentopdf/"});i.addEventListener("click",F);r("Select JSON files to get started","info");k();
