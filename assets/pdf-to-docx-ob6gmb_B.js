const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jszip.min-DhcferR8.js","assets/main-DSprMeGA.js","assets/style-BMqLG_Qf.js","assets/style-CsosqKDh.css","assets/_commonjs-dynamic-modules-TDtrdbi3.js"])))=>i.map(i=>d[i]);
import{c as _,i as $}from"./style-BMqLG_Qf.js";import"./lucide-init-Css57rKe.js";import"./simple-mode-footer-WbVs9YeG.js";import"./version-Cc_uNslJ.js";import{s as n,a as g,b as p,d as w,h as L,_ as F,f as x,r as P,c as k}from"./main-DSprMeGA.js";import{l as A}from"./pymupdf-loader-BmwcVkri.js";import"./mobileMenu-BoMunYmR.js";import"./wasm-provider-BDZaM2k5.js";document.addEventListener("DOMContentLoaded",()=>{const l=document.getElementById("file-input"),i=document.getElementById("drop-zone"),d=document.getElementById("process-btn"),u=document.getElementById("file-display-area"),v=document.getElementById("convert-options"),y=document.getElementById("file-controls"),B=document.getElementById("add-more-btn"),b=document.getElementById("clear-files-btn"),C=document.getElementById("back-to-tools");C&&C.addEventListener("click",()=>{window.location.href="/"});const h=async()=>{if(!(!u||!v||!d||!y))if(n.files.length>0){u.innerHTML="";for(let e=0;e<n.files.length;e++){const t=n.files[e],s=document.createElement("div");s.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const r=document.createElement("div");r.className="flex flex-col overflow-hidden";const a=document.createElement("div");a.className="truncate font-medium text-gray-200 text-sm mb-1",a.textContent=t.name;const o=document.createElement("div");o.className="text-xs text-gray-400",o.textContent=`${x(t.size)} • Loading pages...`,r.append(a,o);const c=document.createElement("button");c.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",c.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',c.onclick=()=>{n.files=n.files.filter((f,m)=>m!==e),h()},s.append(r,c),u.appendChild(s);try{const f=await P(t),m=await k({data:f}).promise;o.textContent=`${x(t.size)} • ${m.numPages} pages`}catch{o.textContent=`${x(t.size)} • Could not load page count`}}_({icons:$}),y.classList.remove("hidden"),v.classList.remove("hidden"),d.disabled=!1}else u.innerHTML="",y.classList.add("hidden"),v.classList.add("hidden"),d.disabled=!0},E=()=>{n.files=[],n.pdfDoc=null,h()},I=async()=>{try{if(n.files.length===0){g("No Files","Please select at least one PDF file.");return}p("Loading PDF converter...");const e=await A();if(n.files.length===1){const t=n.files[0];p(`Converting ${t.name}...`);const s=await e.pdfToDocx(t),r=t.name.replace(/\.pdf$/i,"")+".docx";w(s,r),L(),g("Conversion Complete",`Successfully converted ${t.name} to DOCX.`,"success",()=>E())}else{p("Converting multiple PDFs...");const t=(await F(async()=>{const{default:a}=await import("./jszip.min-DhcferR8.js").then(o=>o.j);return{default:a}},__vite__mapDeps([0,1,2,3,4]))).default,s=new t;for(let a=0;a<n.files.length;a++){const o=n.files[a];p(`Converting ${a+1}/${n.files.length}: ${o.name}...`);const c=await e.pdfToDocx(o),f=o.name.replace(/\.pdf$/i,""),m=await c.arrayBuffer();s.file(`${f}.docx`,m)}p("Creating ZIP archive...");const r=await s.generateAsync({type:"blob"});w(r,"converted-documents.zip"),L(),g("Conversion Complete",`Successfully converted ${n.files.length} PDF(s) to DOCX.`,"success",()=>E())}}catch(e){L(),g("Error",`An error occurred during conversion. Error: ${e.message}`)}},D=e=>{if(e&&e.length>0){const t=Array.from(e).filter(s=>s.type==="application/pdf"||s.name.toLowerCase().endsWith(".pdf"));n.files=[...n.files,...t],h()}};l&&i&&(l.addEventListener("change",e=>{D(e.target.files)}),i.addEventListener("dragover",e=>{e.preventDefault(),i.classList.add("bg-gray-700")}),i.addEventListener("dragleave",e=>{e.preventDefault(),i.classList.remove("bg-gray-700")}),i.addEventListener("drop",e=>{e.preventDefault(),i.classList.remove("bg-gray-700");const t=e.dataTransfer?.files;t&&t.length>0&&D(t)}),l.addEventListener("click",()=>{l.value=""})),B&&B.addEventListener("click",()=>{l.click()}),b&&b.addEventListener("click",()=>{E()}),d&&d.addEventListener("click",I)});
