import{c as w,i as x}from"./style-BMqLG_Qf.js";import"./lucide-init-Css57rKe.js";import"./simple-mode-footer-WbVs9YeG.js";import"./version-Cc_uNslJ.js";import{a as f,b as v,d as E,h as L,f as k}from"./main-DSprMeGA.js";import{J as I}from"./jszip.min-DhcferR8.js";import{l as B}from"./pymupdf-loader-BmwcVkri.js";import"./mobileMenu-BoMunYmR.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./wasm-provider-BDZaM2k5.js";let d=null;const h=()=>{const a=document.getElementById("file-display-area"),e=document.getElementById("options-panel");if(!(!a||!e))if(a.innerHTML="",d){e.classList.remove("hidden");const n=document.createElement("div");n.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const o=document.createElement("div");o.className="flex flex-col overflow-hidden";const i=document.createElement("div");i.className="truncate font-medium text-gray-200 text-sm mb-1",i.textContent=d.name;const t=document.createElement("div");t.className="text-xs text-gray-400",t.textContent=k(d.size),o.append(i,t);const s=document.createElement("button");s.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",s.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',s.onclick=y,n.append(o,s),a.appendChild(n),w({icons:x})}else e.classList.add("hidden")},y=()=>{d=null;const a=document.getElementById("file-input");a&&(a.value=""),h()};function b(a){return a.map(e=>e.map(n=>{const o=n??"";return o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}).join(",")).join(`
`)}async function C(){if(!d){f("No File","Please upload a PDF file first.");return}const a=document.querySelectorAll('input[name="export-format"]');let e="csv";a.forEach(n=>{n.checked&&(e=n.value)});try{v("Loading Engine...");const n=await B();v("Extracting tables...");const o=await n.open(d),i=o.pageCount,t=d.name.replace(/\.[^/.]+$/,""),s=[];for(let l=0;l<i;l++)v(`Scanning page ${l+1} of ${i}...`),o.getPage(l).findTables().forEach((r,u)=>{s.push({page:l+1,tableIndex:u+1,rows:r.rows,markdown:r.markdown,rowCount:r.rowCount,colCount:r.colCount})});if(s.length===0){f("No Tables Found","No tables were detected in this PDF.");return}if(s.length===1){const l=s[0];let m,c,r;e==="csv"?(m=b(l.rows),c="csv",r="text/csv"):e==="json"?(m=JSON.stringify(l.rows,null,2),c="json",r="application/json"):(m=l.markdown,c="md",r="text/markdown");const u=new Blob([m],{type:r});E(u,`${t}_table.${c}`),f("Success","Extracted 1 table successfully!","success",y)}else{v("Creating ZIP file...");const l=new I;s.forEach((c,r)=>{const u=`table_${r+1}_page${c.page}`;let p,g;e==="csv"?(p=b(c.rows),g="csv"):e==="json"?(p=JSON.stringify(c.rows,null,2),g="json"):(p=c.markdown,g="md"),l.file(`${u}.${g}`,p)});const m=await l.generateAsync({type:"blob"});E(m,`${t}_tables.zip`),f("Success",`Extracted ${s.length} tables successfully!`,"success",y)}}catch(n){console.error(n);const o=n instanceof Error?n.message:"Unknown error";f("Error",`Failed to extract tables. ${o}`)}finally{L()}}document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("file-input"),e=document.getElementById("drop-zone"),n=document.getElementById("process-btn"),o=document.getElementById("back-to-tools");o&&o.addEventListener("click",()=>{window.location.href="/"});const i=t=>{if(!t||t.length===0)return;const s=Array.from(t).find(l=>l.type==="application/pdf");if(!s){f("Invalid File","Please upload a PDF file.");return}d=s,h()};a&&e&&(a.addEventListener("change",t=>{i(t.target.files)}),e.addEventListener("dragover",t=>{t.preventDefault(),e.classList.add("bg-gray-700")}),e.addEventListener("dragleave",t=>{t.preventDefault(),e.classList.remove("bg-gray-700")}),e.addEventListener("drop",t=>{t.preventDefault(),e.classList.remove("bg-gray-700"),i(t.dataTransfer?.files??null)}),a.addEventListener("click",()=>{a.value=""})),n&&n.addEventListener("click",C)});
