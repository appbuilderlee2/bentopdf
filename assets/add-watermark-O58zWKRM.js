import{c as f,i as g}from"./style-DHqpffR4.js";import"./lucide-init-b51_Izr7.js";import"./simple-mode-footer-CTXl6sKe.js";import"./version-Cc_uNslJ.js";import{a as s,b as y,h as E,f as w,n as h,r as L,d as k}from"./main-X9THBjap.js";import{P as D}from"./PDFButton-B7ekbw-1.js";import{b,c as F}from"./pdf-operations-C69fooj2.js";import"./mobileMenu-BoMunYmR.js";import"./index-YkV0U4e7.js";const r={file:null,pdfDoc:null};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",p):p();function p(){f({icons:g});const t=document.getElementById("file-input"),e=document.getElementById("drop-zone"),a=document.getElementById("back-to-tools"),n=document.getElementById("process-btn");t&&(t.addEventListener("change",P),t.addEventListener("click",()=>{t.value=""})),e&&(e.addEventListener("dragover",o=>{o.preventDefault(),e.classList.add("border-indigo-500")}),e.addEventListener("dragleave",()=>{e.classList.remove("border-indigo-500")}),e.addEventListener("drop",o=>{o.preventDefault(),e.classList.remove("border-indigo-500"),o.dataTransfer?.files.length&&v(o.dataTransfer.files)})),a&&a.addEventListener("click",()=>{window.location.href="/bentopdf/"}),n&&n.addEventListener("click",C),S()}function P(t){const e=t.target;e.files?.length&&v(e.files)}async function v(t){const e=t[0];if(!e||e.type!=="application/pdf"){s("Invalid File","Please upload a valid PDF file.");return}y("Loading PDF...");try{const a=await e.arrayBuffer();r.pdfDoc=await D.load(a),r.file=e,T(),document.getElementById("options-panel")?.classList.remove("hidden")}catch(a){console.error(a),s("Error","Failed to load PDF file.")}finally{E()}}function T(){const t=document.getElementById("file-display-area");if(!t||!r.file||!r.pdfDoc)return;t.innerHTML="";const e=document.createElement("div");e.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg";const a=document.createElement("div");a.className="flex flex-col flex-1 min-w-0";const n=document.createElement("div");n.className="truncate font-medium text-gray-200 text-sm mb-1",n.textContent=r.file.name;const o=document.createElement("div");o.className="text-xs text-gray-400",o.textContent=`${w(r.file.size)} â€¢ ${r.pdfDoc.getPageCount()} pages`,a.append(n,o);const i=document.createElement("button");i.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",i.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',i.onclick=x,e.append(a,i),t.appendChild(e),f({icons:g})}function x(){r.file=null,r.pdfDoc=null;const t=document.getElementById("file-display-area");t&&(t.innerHTML=""),document.getElementById("options-panel")?.classList.add("hidden");const e=document.getElementById("file-input");e&&(e.value="")}function S(){const t=document.querySelectorAll('input[name="watermark-type"]'),e=document.getElementById("text-watermark-options"),a=document.getElementById("image-watermark-options");t.forEach(I=>{I.addEventListener("change",B=>{B.target.value==="text"?(e?.classList.remove("hidden"),a?.classList.add("hidden")):(e?.classList.add("hidden"),a?.classList.remove("hidden"))})});const n=document.getElementById("opacity-text"),o=document.getElementById("opacity-value-text"),i=document.getElementById("angle-text"),d=document.getElementById("angle-value-text");n?.addEventListener("input",()=>{o&&(o.textContent=n.value)}),i?.addEventListener("input",()=>{d&&(d.textContent=i.value)});const l=document.getElementById("opacity-image"),c=document.getElementById("opacity-value-image"),m=document.getElementById("angle-image"),u=document.getElementById("angle-value-image");l?.addEventListener("input",()=>{c&&(c.textContent=l.value)}),m?.addEventListener("input",()=>{u&&(u.textContent=m.value)})}async function C(){if(!r.pdfDoc){s("Error","Please upload a PDF file first.");return}const t=document.querySelector('input[name="watermark-type"]:checked')?.value||"text";y("Adding watermark...");try{const e=new Uint8Array(await r.pdfDoc.save());let a;if(t==="text"){const n=document.getElementById("watermark-text").value;if(!n.trim())throw new Error("Please enter text for the watermark.");const o=parseInt(document.getElementById("font-size").value)||72,i=parseInt(document.getElementById("angle-text").value)||0,d=parseFloat(document.getElementById("opacity-text").value)||.3,l=document.getElementById("text-color").value,c=h(l);a=await b(e,{text:n,fontSize:o,color:c,opacity:d,angle:i})}else{const n=document.getElementById("image-watermark-input").files?.[0];if(!n)throw new Error("Please select an image file for the watermark.");const o=await L(n),i=parseInt(document.getElementById("angle-image").value)||0,d=parseFloat(document.getElementById("opacity-image").value)||.3;let l;if(n.type==="image/png")l="png";else if(n.type==="image/jpeg")l="jpg";else throw new Error("Unsupported Image. Please use a PNG or JPG for the watermark.");a=await F(e,{imageBytes:new Uint8Array(o),imageType:l,opacity:d,angle:i,scale:1})}k(new Blob([a.buffer],{type:"application/pdf"}),"watermarked.pdf"),s("Success","Watermark added successfully!","success",()=>{x()})}catch(e){console.error(e),s("Error",e.message||"Could not add the watermark.")}finally{E()}}
