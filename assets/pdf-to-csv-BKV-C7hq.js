import{c as p,i as g}from"./style-BMqLG_Qf.js";import"./lucide-init-Css57rKe.js";import"./simple-mode-footer-WbVs9YeG.js";import"./version-Cc_uNslJ.js";import{a as i,b as d,d as v,h as y,f as E}from"./main-DSprMeGA.js";import{l as h}from"./pymupdf-loader-BmwcVkri.js";import"./mobileMenu-BoMunYmR.js";import"./wasm-provider-BDZaM2k5.js";let c=null;const m=()=>{const e=document.getElementById("file-display-area"),t=document.getElementById("options-panel");if(!(!e||!t))if(e.innerHTML="",c){t.classList.remove("hidden");const o=document.createElement("div");o.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const a=document.createElement("div");a.className="flex flex-col overflow-hidden";const s=document.createElement("div");s.className="truncate font-medium text-gray-200 text-sm mb-1",s.textContent=c.name;const n=document.createElement("div");n.className="text-xs text-gray-400",n.textContent=E(c.size),a.append(s,n);const r=document.createElement("button");r.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",r.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',r.onclick=u,o.append(a,r),e.appendChild(o),p({icons:g})}else t.classList.add("hidden")},u=()=>{c=null;const e=document.getElementById("file-input");e&&(e.value=""),m()};function b(e){return e.map(t=>t.map(o=>{const a=o??"";return a.includes(",")||a.includes('"')||a.includes(`
`)?`"${a.replace(/"/g,'""')}"`:a}).join(",")).join(`
`)}async function L(){if(!c){i("No File","Please upload a PDF file first.");return}d("Loading Engine...");try{const e=await h();d("Extracting tables...");const t=await e.open(c),o=t.pageCount,a=c.name.replace(/\.[^/.]+$/,""),s=[];for(let l=0;l<o;l++)d(`Scanning page ${l+1} of ${o}...`),t.getPage(l).findTables().forEach(f=>{s.push(...f.rows),s.push([])});if(s.length===0){i("No Tables Found","No tables were detected in this PDF.");return}const n=b(s.filter(l=>l.length>0)),r=new Blob([n],{type:"text/csv;charset=utf-8;"});v(r,`${a}.csv`),i("Success","PDF converted to CSV successfully!","success",u)}catch(e){console.error(e);const t=e instanceof Error?e.message:"Unknown error";i("Error",`Failed to convert PDF to CSV. ${t}`)}finally{y()}}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("file-input"),t=document.getElementById("drop-zone"),o=document.getElementById("process-btn"),a=document.getElementById("back-to-tools");a&&a.addEventListener("click",()=>{window.location.href="/"});const s=n=>{if(!n||n.length===0)return;const r=Array.from(n).find(l=>l.type==="application/pdf");if(!r){i("Invalid File","Please upload a PDF file.");return}c=r,m()};e&&t&&(e.addEventListener("change",n=>{s(n.target.files)}),t.addEventListener("dragover",n=>{n.preventDefault(),t.classList.add("bg-gray-700")}),t.addEventListener("dragleave",n=>{n.preventDefault(),t.classList.remove("bg-gray-700")}),t.addEventListener("drop",n=>{n.preventDefault(),t.classList.remove("bg-gray-700"),s(n.dataTransfer?.files??null)}),e.addEventListener("click",()=>{e.value=""})),o&&o.addEventListener("click",L)});
