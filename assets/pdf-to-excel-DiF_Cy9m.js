import{c as v,i as E}from"./style-DHqpffR4.js";import"./lucide-init-b51_Izr7.js";import"./simple-mode-footer-CTXl6sKe.js";import"./version-Cc_uNslJ.js";import{a as d,b as m,d as y,h as x,f as w}from"./main-X9THBjap.js";import{l as L}from"./pymupdf-loader-DSwOn04P.js";import{utils as c,write as k}from"./xlsx-DLWyRTOj.js";import"./mobileMenu-BoMunYmR.js";import"./wasm-provider-C9fvsoLq.js";let i=null;const h=()=>{const t=document.getElementById("file-display-area"),n=document.getElementById("options-panel");if(!(!t||!n))if(t.innerHTML="",i){n.classList.remove("hidden");const s=document.createElement("div");s.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const l=document.createElement("div");l.className="flex flex-col overflow-hidden";const o=document.createElement("div");o.className="truncate font-medium text-gray-200 text-sm mb-1",o.textContent=i.name;const e=document.createElement("div");e.className="text-xs text-gray-400",e.textContent=w(i.size),l.append(o,e);const r=document.createElement("button");r.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",r.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',r.onclick=b,s.append(l,r),t.appendChild(s),v({icons:E})}else n.classList.add("hidden")},b=()=>{i=null;const t=document.getElementById("file-input");t&&(t.value=""),h()};async function B(){if(!i){d("No File","Please upload a PDF file first.");return}m("Loading Engine...");try{const t=await L();m("Extracting tables...");const n=await t.open(i),s=n.pageCount,l=i.name.replace(/\.[^/.]+$/,""),o=[];for(let a=0;a<s;a++)m(`Scanning page ${a+1} of ${s}...`),n.getPage(a).findTables().forEach(f=>{o.push({page:a+1,rows:f.rows})});if(o.length===0){d("No Tables Found","No tables were detected in this PDF.");return}m("Creating Excel file...");const e=c.book_new();if(o.length===1){const a=c.aoa_to_sheet(o[0].rows);c.book_append_sheet(e,a,"Table")}else o.forEach((a,u)=>{const g=`Table ${u+1} (Page ${a.page})`.substring(0,31),f=c.aoa_to_sheet(a.rows);c.book_append_sheet(e,f,g)});const r=k(e,{bookType:"xlsx",type:"array"}),p=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});y(p,`${l}.xlsx`),d("Success",`Extracted ${o.length} table(s) to Excel!`,"success",b)}catch(t){console.error(t);const n=t instanceof Error?t.message:"Unknown error";d("Error",`Failed to convert PDF to Excel. ${n}`)}finally{x()}}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("file-input"),n=document.getElementById("drop-zone"),s=document.getElementById("process-btn"),l=document.getElementById("back-to-tools");l&&l.addEventListener("click",()=>{window.location.href="/bentopdf/"});const o=e=>{if(!e||e.length===0)return;const r=Array.from(e).find(p=>p.type==="application/pdf");if(!r){d("Invalid File","Please upload a PDF file.");return}i=r,h()};t&&n&&(t.addEventListener("change",e=>{o(e.target.files)}),n.addEventListener("dragover",e=>{e.preventDefault(),n.classList.add("bg-gray-700")}),n.addEventListener("dragleave",e=>{e.preventDefault(),n.classList.remove("bg-gray-700")}),n.addEventListener("drop",e=>{e.preventDefault(),n.classList.remove("bg-gray-700"),o(e.dataTransfer?.files??null)}),t.addEventListener("click",()=>{t.value=""})),s&&s.addEventListener("click",B)});
