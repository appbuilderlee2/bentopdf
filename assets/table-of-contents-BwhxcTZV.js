import"./style-DHqpffR4.js";import"./lucide-init-b51_Izr7.js";import"./simple-mode-footer-CTXl6sKe.js";import{d as b,f as y}from"./main-X9THBjap.js";import{i as k}from"./shortcuts-init-BgrycUj-.js";import{isCpdfAvailable as E}from"./cpdf-helper-DR2eaTKq.js";import{s as v,W as B}from"./wasm-provider-C9fvsoLq.js";import"./mobileMenu-BoMunYmR.js";import"./version-Cc_uNslJ.js";const c=new Worker("/bentopdf/workers/table-of-contents.worker.js");let l=null;const a=document.getElementById("drop-zone"),m=document.getElementById("file-input"),s=document.getElementById("generate-btn"),h=document.getElementById("toc-title"),w=document.getElementById("font-size"),L=document.getElementById("font-family"),I=document.getElementById("add-bookmark"),i=document.getElementById("status-message"),d=document.getElementById("file-display-area"),f=document.getElementById("back-to-tools");function r(e,t="info"){i.textContent=e,i.className=`mt-4 p-3 rounded-lg text-sm ${t==="success"?"bg-green-900 text-green-200":t==="error"?"bg-red-900 text-red-200":"bg-blue-900 text-blue-200"}`,i.classList.remove("hidden")}function x(){i.classList.add("hidden")}function D(e){d.innerHTML="",d.classList.remove("hidden");const t=document.createElement("div");t.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const n=document.createElement("span");n.className="truncate font-medium text-gray-200",n.textContent=e.name;const o=document.createElement("span");o.className="flex-shrink-0 ml-4 text-gray-400",o.textContent=y(e.size),t.append(n,o),d.appendChild(t)}function u(e){if(e.type!=="application/pdf"){r("Please select a PDF file.","error");return}l=e,s.disabled=!1,D(e)}a.addEventListener("dragover",e=>{e.preventDefault(),a.classList.add("border-blue-500")});a.addEventListener("dragleave",()=>{a.classList.remove("border-blue-500")});a.addEventListener("drop",e=>{e.preventDefault(),a.classList.remove("border-blue-500");const t=e.dataTransfer?.files[0];t&&u(t)});m.addEventListener("change",e=>{const t=e.target.files?.[0];t&&u(t)});async function S(){if(!l){r("Please select a PDF file first.","error");return}if(!E()){v("cpdf");return}try{s.disabled=!0,r("Reading file (Main Thread)...","info");const e=await l.arrayBuffer();r("Generating table of contents...","info");const t=h.value||"Table of Contents",n=parseInt(w.value,10),o=parseInt(L.value,10),p=I.checked,g={command:"generate-toc",pdfData:e,title:t,fontSize:n,fontFamily:o,addBookmark:p,cpdfUrl:B.getUrl("cpdf")+"coherentpdf.browser.min.js"};c.postMessage(g,[e])}catch(e){console.error("Error reading file:",e),r(`Error reading file: ${e instanceof Error?e.message:"Unknown error occurred"}`,"error"),s.disabled=!1}}c.onmessage=e=>{if(s.disabled=!1,e.data.status==="success"){const t=e.data.pdfBytes,n=new Uint8Array(t),o=new Blob([n],{type:"application/pdf"});b(o,l?.name.replace(".pdf","_with_toc.pdf")||"output_with_toc.pdf"),r("Table of contents generated successfully! Download started.","success"),x(),l=null,m.value="",d.innerHTML="",d.classList.add("hidden"),s.disabled=!0}else if(e.data.status==="error"){const t=e.data.message||"Unknown error occurred in worker.";console.error("Worker Error:",t),r(`Error: ${t}`,"error")}};c.onerror=e=>{console.error("Worker error:",e),r("Worker error occurred. Check console for details.","error"),s.disabled=!1};f&&f.addEventListener("click",()=>{window.location.href="/bentopdf/"});s.addEventListener("click",S);k();
