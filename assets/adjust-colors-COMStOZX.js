import{c as V,i as A}from"./style-BMqLG_Qf.js";import"./lucide-init-Css57rKe.js";import"./simple-mode-footer-WbVs9YeG.js";import"./version-Cc_uNslJ.js";import{G as j,a as c,b as h,r as v,c as y,h as b,d as N,f}from"./main-DSprMeGA.js";import{P as $}from"./PDFButton-BowUC9ah.js";import{c as z}from"./image-effects-Lmx2y_xU.js";import"./mobileMenu-BoMunYmR.js";import"./index-YkV0U4e7.js";j.workerSrc=new URL("/assets/pdf.worker.min-LyOxJPrg.mjs",import.meta.url).toString();let d=[],u=null,P=0,L=0,m=null;function C(){return{brightness:parseInt(document.getElementById("setting-brightness")?.value??"0"),contrast:parseInt(document.getElementById("setting-contrast")?.value??"0"),saturation:parseInt(document.getElementById("setting-saturation")?.value??"0"),hueShift:parseInt(document.getElementById("setting-hue-shift")?.value??"0"),temperature:parseInt(document.getElementById("setting-temperature")?.value??"0"),tint:parseInt(document.getElementById("setting-tint")?.value??"0"),gamma:parseFloat(document.getElementById("setting-gamma")?.value??"1.0"),sepia:parseInt(document.getElementById("setting-sepia")?.value??"0")}}const D=z;function w(){if(!u)return;const n=document.getElementById("preview-canvas");if(!n)return;const a=C(),e=new ImageData(new Uint8ClampedArray(u.data),P,L);D(e,n,a)}async function T(){if(!m)return;const n=await m.getPage(1),a=n.getViewport({scale:1}),e=document.createElement("canvas"),s=e.getContext("2d");e.width=a.width,e.height=a.height,await n.render({canvasContext:s,viewport:a,canvas:e}).promise,u=s.getImageData(0,0,e.width,e.height),P=e.width,L=e.height,w()}const E=()=>{const n=document.getElementById("file-display-area"),a=document.getElementById("options-panel");!n||!a||(n.innerHTML="",d.length>0?(a.classList.remove("hidden"),d.forEach(e=>{const s=document.createElement("div");s.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const i=document.createElement("div");i.className="flex flex-col overflow-hidden";const t=document.createElement("div");t.className="truncate font-medium text-gray-200 text-sm mb-1",t.textContent=e.name;const r=document.createElement("div");r.className="text-xs text-gray-400",r.textContent=`${f(e.size)} • Loading pages...`,i.append(t,r);const o=document.createElement("button");o.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",o.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',o.onclick=()=>{d=[],m=null,u=null,E()},s.append(i,o),n.appendChild(s),v(e).then(l=>y(l).promise).then(l=>{r.textContent=`${f(e.size)} • ${l.numPages} page${l.numPages!==1?"s":""}`}).catch(()=>{r.textContent=f(e.size)})}),V({icons:A})):a.classList.add("hidden"))},U=()=>{d=[],m=null,u=null;const n=document.getElementById("file-input");n&&(n.value=""),E()};async function H(){if(d.length===0){c("No File","Please upload a PDF file first.");return}h("Applying color adjustments...");try{const n=C(),a=await v(d[0]),e=await y({data:a}).promise,s=await $.create();for(let t=1;t<=e.numPages;t++){h(`Processing page ${t} of ${e.numPages}...`);const r=await e.getPage(t),o=r.getViewport({scale:2}),l=document.createElement("canvas"),I=l.getContext("2d");l.width=o.width,l.height=o.height,await r.render({canvasContext:I,viewport:o,canvas:l}).promise;const k=I.getImageData(0,0,l.width,l.height),B=document.createElement("canvas");D(k,B,n);const x=await new Promise(p=>B.toBlob(p,"image/png"));if(x){const p=await x.arrayBuffer(),S=await s.embedPng(p),g=r.getViewport({scale:1});s.addPage([g.width,g.height]).drawImage(S,{x:0,y:0,width:g.width,height:g.height})}}const i=await s.save();N(new Blob([new Uint8Array(i)],{type:"application/pdf"}),"color-adjusted.pdf"),c("Success","Color adjustments applied successfully!","success",()=>{U()})}catch(n){console.error(n),c("Error","Failed to apply color adjustments. The file might be corrupted.")}finally{b()}}const F=[{id:"setting-brightness",display:"brightness-value",suffix:"",defaultValue:"0"},{id:"setting-contrast",display:"contrast-value",suffix:"",defaultValue:"0"},{id:"setting-saturation",display:"saturation-value",suffix:"",defaultValue:"0"},{id:"setting-hue-shift",display:"hue-shift-value",suffix:"°",defaultValue:"0"},{id:"setting-temperature",display:"temperature-value",suffix:"",defaultValue:"0"},{id:"setting-tint",display:"tint-value",suffix:"",defaultValue:"0"},{id:"setting-gamma",display:"gamma-value",suffix:"",defaultValue:"1.0"},{id:"setting-sepia",display:"sepia-value",suffix:"",defaultValue:"0"}];function M(){F.forEach(({id:n,display:a,suffix:e,defaultValue:s})=>{const i=document.getElementById(n),t=document.getElementById(a);i&&(i.value=s),t&&(t.textContent=s+e)}),w()}function O(){F.forEach(({id:a,display:e,suffix:s})=>{const i=document.getElementById(a),t=document.getElementById(e);i&&t&&i.addEventListener("input",()=>{t.textContent=i.value+s,w()})});const n=document.getElementById("reset-settings-btn");n&&n.addEventListener("click",M)}document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("file-input"),a=document.getElementById("drop-zone"),e=document.getElementById("process-btn"),s=document.getElementById("back-to-tools");s&&s.addEventListener("click",()=>{window.location.href="/"});const i=async t=>{if(!t||t.length===0)return;const r=Array.from(t).filter(o=>o.type==="application/pdf");if(r.length===0){c("Invalid File","Please upload a PDF file.");return}d=[r[0]],E(),h("Loading preview...");try{const o=await v(r[0]);m=await y({data:o}).promise,await T()}catch(o){console.error(o),c("Error","Failed to load PDF for preview.")}finally{b()}};n&&a&&(n.addEventListener("change",t=>{i(t.target.files)}),a.addEventListener("dragover",t=>{t.preventDefault(),a.classList.add("bg-gray-700")}),a.addEventListener("dragleave",t=>{t.preventDefault(),a.classList.remove("bg-gray-700")}),a.addEventListener("drop",t=>{t.preventDefault(),a.classList.remove("bg-gray-700"),i(t.dataTransfer?.files??null)}),n.addEventListener("click",()=>{n.value=""})),e&&e.addEventListener("click",H),O()});
